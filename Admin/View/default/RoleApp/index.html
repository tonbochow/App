<extend name="Public:base" />

<block name="content">
    <ol class="breadcrumb">
        <li><a href="/Admin">后台首页</a></li>
        <li><a href="/Admin/{$Think.CONTROLLER_NAME}">角色应用管理</a></li>
        <li class="active">{$Think.ACTION_NAME}</li>
    </ol>

    <div class="table-responsive panel panel-primary" ng-controller="RoleAppController">
        <div class="panel-heading">
            <B>角色应用管理 | 角色应用列表</B>
            <a href="/Admin/RoleApp/add" class="btn btn-success" role="button"><i class="icon-plus"></i> 添加</a>
        </div>
        <table class="table table-bordered table-hover table-striped">
            <tr>
                <th>角色ID</th>
                <th>角色名称</th>
                <th>应用ids</th>
                <th>状态</th>
                <th>创建时间</th>
                <th>更新时间</th>
                <th>操作</th>
            </tr>
            <volist name="role_app" id="role">
                <tr id="{$role.id}">
                <td>{$role.role_id}</td>
                <td>{$role.role_name}</td>
                <td>{$role.app_ids}</td>
                <td>{$role.status}</td>
                <td>{$role.create_time|date="Y-m-d H:i:s",###}</td>
                <td>{$role.update_time|date="Y-m-d H:i:s",###}</td>
                <td>
                    <a href="/Admin/RoleApp/edit/id/{$role.role_id}" class="btn btn-warning" role="button"><i class="icon-pencil"></i> 编辑</a>
                    <a href="" class="btn btn-danger" role="button"  ng-click="del_RoleApp({$role.role_id})"><i class="icon-trash icon-large"></i> 删除</a>
                </td>
                </tr>
            </volist>
        </table>
    </div>
    <?php echo $page;?>
</block>

<block name="header_script">
    <script type="text/javascript">
        var RoleAppModule = angular.module("baby", []);
        RoleAppModule.controller("RoleAppController", function ($scope, $http) {
            //删除某角色
            $scope.del_RoleApp = function (id) {
                $scope.app = {role_id: id};
                $http({
                    method: "POST",
                    url: "/Admin/RoleApp/delete",
                    data: $.param($scope.app),
                    headers: {'Content-Type': 'application/x-www-form-urlencoded'}
                }).success(function (data) {
                    if (data.status) {
                        $scope.success = data.success;
                        window.location.href = '/Admin/RoleApp/index';
                    } else {
                        $scope.message = data.message;
                    }
                });
            };
        });
    </script>
</block>